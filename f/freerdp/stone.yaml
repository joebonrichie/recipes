#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : freerdp
version     : 3.17.2
release     : 14
homepage    : www.freerdp.com
upstreams   :
    - https://github.com/FreeRDP/FreeRDP/releases/download/3.17.2/freerdp-3.17.2.tar.gz : c42c712ad879bf06607b78b8c3fad98e08c82f73f4e0bc1693552900041e692a
summary     : FreeRDP is a free remote desktop protocol library and clients  
description : |
    FreeRDP is a free implementation of the Remote Desktop Protocol (RDP), released 
    under the Apache license. Enjoy the freedom of using your software wherever you 
    want, the way you want it, in a world where interoperability can finally liberate 
    your computing experience.
license     :
    - Apache-2.0
builddeps   :
    - pkgconfig(alsa)
    - pkgconfig(cairo)
    - pkgconfig(cups)
    - pkgconfig(fdk-aac)
    - pkgconfig(fuse3)
    - pkgconfig(json-c)
    - pkgconfig(libavcodec)
    - pkgconfig(libavutil)
    - pkgconfig(libcjson)
    - pkgconfig(libpulse)
    - pkgconfig(libswscale)
    - pkgconfig(libsystemd)
    - pkgconfig(libusb-1.0)
    - pkgconfig(libxslt)
    - pkgconfig(mit-krb5)
    - pkgconfig(openssl)
    - pkgconfig(sdl3-ttf)
    - pkgconfig(wayland-scanner)
    - pkgconfig(x11)
    - pkgconfig(xcursor)
    - pkgconfig(xdamage)
    - pkgconfig(xext)
    - pkgconfig(xi)
    - pkgconfig(xinerama)
    - pkgconfig(xkbcommon)
    - pkgconfig(xkbfile)
    - pkgconfig(xrandr)
    - pkgconfig(xv)
    # TODO: uriparser, heimdal-krb5 (?)
setup       : |
    %cmake \
      -DCMAKE_SKIP_INSTALL_RPATH=ON \
      -DWITH_CAIRO=ON \
      -DWITH_DSP_FFMPEG=ON \
      -DWITH_FDK_AAC=ON \
      -DWITH_FFMPEG=ON \
      -DWITH_INTERNAL_RC4=ON \
      -DWITH_MANPAGES=ON \
      -DWITH_PCSC=OFF \
      -DWITH_PULSE=ON \
      -DWITH_SERVER=ON \
      -DWITH_SWSCALE=ON \
      -DWITH_VAAPI=ON \
      -DWITH_WAYLAND=ON
build       : |
    %cmake_build
install     : |
    %cmake_install
packages    :
    - "%(name)-libs":
        summary: Core libraries implementing the RDP protocol
        description: Core libraries implementing the RDP protocol
        paths:
            - /usr/lib/freerdp3/
            - /usr/lib/libfreerdp3.so.*
            - /usr/lib/libfreerdp-client3.so.*
            - /usr/lib/libfreerdp-server3.so.*
            - /usr/lib/libfreerdp-shadow3.so.*
            - /usr/lib/libfreerdp-server-proxy3.so.*
            - /usr/lib/libfreerdp-shadow-subsystem3.so.*
            - /usr/lib/librdtk0.so.*
            - /usr/lib/libuwac0.so.*
            - /usr/share/FreeRDP/
            - /usr/share/man/man7/wlog.7*

    - "%(name)-devel":
        rundeps:
            # Referenced by FreeRDP-Client3
            - pkgconfig(fuse3)
            # Referenced by FreeRDPConfig.cmake
            - "libwinpr-devel"

    - "libwinpr":
        summary: Windows Portable Runtime
        description: Windows Portable Runtime
        paths:
            - /usr/lib/libwinpr3.so.*
            - /usr/lib/libwinpr-tools3.so.*

    - "libwinpr-devel":
        rundeps:
            - libwinpr
        paths:
            - /usr/include/winpr3/
            - /usr/lib/cmake/WinPR*/
            - /usr/lib/pkgconfig/winpr*.pc
            - /usr/lib/libwinpr3.so
            - /usr/lib/libwinpr-tools3.so
