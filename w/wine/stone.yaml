#
# SPDX-FileCopyrightText: Â© 2020-2025 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : wine
version     : "10.17"
release     : 14
homepage    : https://www.winehq.org
upstreams   :
    - https://dl.winehq.org/wine/source/10.x/wine-10.17.tar.xz : bbf8e7de32cea9fe305361d4af85e30492254c4bf02039ee26dac7a66701b4e6
summary     : Wine is a program which allows running Microsoft Windows programs on Unix.
description : |
    Wine is a program which allows running Microsoft Windows programs
    (including DOS, Windows 3.x, Win32, and Win64 executables) on Unix.
    It consists of a program loader which loads and executes a Microsoft
    Windows binary, and a library (called Winelib) that implements Windows
    API calls using their Unix, X11 or Mac equivalents.  The library may also
    be used for porting Windows code into native Unix executables.
license     : LGPL-2.1-or-later
builddeps   :
    - binary(bison)
    - binary(flex)
    - binary(readelf)
    - binary(wayland-scanner)
    - pkgconfig(OpenCL)
    - pkgconfig(OpenCL-Headers)
    - pkgconfig(alsa)
    - pkgconfig(bluez)
    - pkgconfig(cups)
    - pkgconfig(dbus-1)
    - pkgconfig(dri)
    - pkgconfig(egl)
    - pkgconfig(fontconfig)
    - pkgconfig(gbm)
    - pkgconfig(gnutls)
    - pkgconfig(gstreamer-1.0)
    - pkgconfig(gstreamer-tag-1.0)
    - pkgconfig(krb5)
    - pkgconfig(libavcodec)
    - pkgconfig(libavformat)
    - pkgconfig(libavutil)
    - pkgconfig(libgphoto2)
    - pkgconfig(libpcap)
    - pkgconfig(libpcsclite)
    - pkgconfig(libpulse)
    - pkgconfig(libudev)
    - pkgconfig(libusb-1.0)
    - pkgconfig(odbc)
    - pkgconfig(sane-backends)
    - pkgconfig(sdl2-compat)
    - pkgconfig(vulkan)
    - pkgconfig(wayland-eglstream)
    - pkgconfig(wayland-client)
    - pkgconfig(xcursor)
    - pkgconfig(xcomposite)
    - pkgconfig(xi)
    - pkgconfig(xkbcommon)
    - pkgconfig(xrandr)
    - pkgconfig(xxf86vm)
    - pkgconfig(xinerama)
    - pkgconfig(freetype2)
    - gettext-devel
    # TODO Missing deps:
    # libv4l2
setup       : |
    %patch %(pkgdir)/llvm-libunwind.patch

    # Temporarily disabled until properly tested
    # %patch %(pkgdir)/0001-Prefer-wayland-over-x11.patch

    %configure \
        --enable-archs=i386,x86_64 \
        --enable-win64
build       : |
    %make
install     : |
    %make_install

    # when building 64+32 compat, only bare name is emitted, add *64 names for compat
    ln -srv %(installroot)/%(bindir)/wine %(installroot)/%(bindir)/wine64
packages    :
    - "%(name)-devel":
        paths:
            - /usr/bin/function_grep.pl
            - /usr/bin/widl
            - /usr/bin/winebuild
            - /usr/bin/winecpp
            - /usr/bin/winedump
            - /usr/bin/wineg++
            - /usr/bin/winegcc
            - /usr/bin/winemaker
            - /usr/bin/wmc
            - /usr/bin/wrc
            - /usr/share/man/man1/widl*
            - /usr/share/man/man1/winebuild*
            - /usr/share/man/man1/winecpp*
            - /usr/share/man/man1/winedump*
            - /usr/share/man/man1/wineg++*
            - /usr/share/man/man1/winegcc*
            - /usr/share/man/**/man1/winemaker*
            - /usr/share/man/man1/wmc*
            - /usr/share/man/man1/wrc*
