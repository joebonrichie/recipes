#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : wireplumber
version     : 0.5.12
release     : 11
homepage    : https://gitlab.freedesktop.org/pipewire/wireplumber/
upstreams   :
    - https://gitlab.freedesktop.org/pipewire/wireplumber/-/archive/0.5.12/wireplumber-0.5.12.tar.gz : 0ce5cd48087bc5b559d7e1a947e9e0adb2a9b6f1dabd984af801f30fbba5e19c
summary     : Session / policy manager implementation for PipeWire
description : |
    Session / policy manager implementation for PipeWire
license     :
    - MIT
builddeps   :
    - binary(doxygen)
    - binary(g-ir-scanner)
    - binary(msgfmt)
    - binary(sphinx-build)
    - pkgconfig(gio-2.0)
    - pkgconfig(glib-2.0)
    - pkgconfig(gmodule-2.0)
    - pkgconfig(gobject-2.0)
    - pkgconfig(libpipewire-0.3)
    - pkgconfig(libspa-0.2)
    - pkgconfig(libsystemd)
    - pkgconfig(lua)
    - pkgconfig(systemd)
    - python(lxml)
    - python(sphinx)
    - python(sphinx-rtd-theme)
rundeps     :
    - binary(pipewire)
setup       : |
    #https://github.com/ValveSoftware/steam-for-linux/issues/11901
    %patch %(pkgdir)/block_steam_clear_default.patch

    %meson \
        -Dsystem-lua=true
build       : |
    %meson_build
install     : |
    %meson_install
packages    :
    - "%(name)-libs":
        summary: "Library files for %(name)"
        description: |
            Library files for %(name), typically pulled in as a dependency of another package.
        paths:
            - /usr/lib/wireplumber-0.5/libwireplumber-*.so
            - /usr/lib/libwireplumber-0.5.so.*
            - /usr/lib/girepository-1.0/Wp-0.5.typelib
    
    # Moss upgrade issue
    - "%(name)":
        rundeps:
            - "%(name)-libs"
    
    - "%(name)-devel":
        paths:
            # Remove once https://github.com/AerynOS/os-tools/pull/491 is merged
            - /usr/share/gir-1.0/*.gir
