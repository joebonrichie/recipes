#
# SPDX-FileCopyrightText: Â© 2025- AerynOS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : ghostty
version     : "1.3.0-dev+c90f47f"
release     : 2
homepage    : https://github.com/ghostty-org/ghostty
upstreams   :
    - https://github.com/ghostty-org/ghostty/releases/download/tip/ghostty-source.tar.gz : e89419edccf6529d3ffc19fcf857ede70ffc2abd8bc201b3a4f9a480b88355a4
summary     : Ghostty is a fast, feature-rich, and cross-platform terminal emulator that uses platform-native UI and GPU acceleration
description : |
    Ghostty is a terminal emulator that differentiates itself by being fast, feature-rich, and native. While there are many excellent terminal emulators available, they all force you to choose between speed, features, or native UIs. Ghostty provides all three.
license     : MIT
networking  : true
builddeps   :
    - binary(gettext)
    - binary(tic)
    - binary(pandoc)
    - binary(zig)
    - pkgconfig(blueprint-compiler)
    - pkgconfig(freetype2)
    - pkgconfig(gtk4)
    - pkgconfig(gtk4-layer-shell-0)
    - pkgconfig(harfbuzz)
    - pkgconfig(libadwaita-1)
    - pkgconfig(libhwy)
    - pkgconfig(libpng)
    - pkgconfig(libxml-2.0)
    - pkgconfig(oniguruma)
    - pkgconfig(zlib)
    - glslang-devel
environment : |
    export ZIG_GLOBAL_CACHE_DIR=%(builddir)/zig-cache
    export DESTDIR=%(installroot)
setup       : |
    ./nix/build-support/fetch-zig-cache.sh
build       : |
    zig build \
      -j%(jobs) \
      --prefix %(prefix) \
      --system "$ZIG_GLOBAL_CACHE_DIR/p" \
      --summary all \
      --verbose \
      -Doptimize=ReleaseFast \
      -Dcpu=baseline \
      -Dversion-string="%(version)"
install     : |
    # `g/ghostty` already provided by ncurses
    rm -rv %(installroot)/usr/share/terminfo/g
