#
# SPDX-FileCopyrightText: Â© 2020-2025 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : giflib
version     : 5.2.2
release     : 1
upstreams   :
    - https://sourceforge.net/projects/giflib/files/giflib-5.2.2.tar.gz : be7ffbd057cadebe2aa144542fd90c6838c6a083b5e8a9048b8ee3b66b29d5fb
homepage    : http://giflib.sourceforge.net/
license     : MIT
summary     : GIFLIB is a package of portable tools and library routines for working with GIF images
description : |
    The giflib package contains a shared library of functions for loading and saving GIF format image files. It is API and ABI compatible with libungif, the library which supported uncompressed GIFs while the Unisys LZW patent was in effect.
builddeps   :
    - binary(convert) # Doc build
setup       : |
    %patch %(pkgdir)/giflib-5.1.9-fix-missing-quantize-API-symbols.patch
    %patch %(pkgdir)/giflib-5.1.9-make-flags.patch
    %patch %(pkgdir)/security/CVE-2025-31344.patch

    # Install the actual man pages instead of the sources
    sed -e 's|giflib.xml|giflib.7|' -re 's|doc/(.*).xml|doc/\1.1|g' -i Makefile # Install the actual man pages instead of the sources
build       : |
    %make
install     : |
    %make_install \
        PREFIX=%(prefix)
    
    rm -v %(installroot)%(libdir)/*.a
check       : |
    %make -j1 check
packages    :
    - "%(name)-utils":
        summary: Programs for manipulating GIF format image files
        description: Programs for manipulating GIF format image files
        paths:
            - /usr/bin/
            - /usr/share/man/man1
