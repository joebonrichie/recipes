#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : nftables
version     : 1.1.6
release     : 10
homepage    : https://www.netfilter.org/projects/nftables/
upstreams   :
    - https://netfilter.org/pub/nftables/nftables-1.1.6.tar.xz : 372931bda8556b310636a2f9020adc710f9bab66f47efe0ce90bff800ac2530c
summary     : Netfilter nf_tables user library
description : |
    Netfilter nf_tables user library
license     :
    - GPL-2.0-only
builddeps   :
    - binary(python3)
    - pkgconfig(gmp)
    - pkgconfig(jansson)
    - pkgconfig(libmnl)
    - pkgconfig(libnftnl)
    - pkgconfig(readline)
    - python(setuptools)
setup       : |
    # bad loop variable error with dash
    %configure_with_bash \
        --disable-static \
        --sysconfdir=%(vendordir)/ \
        --with-json \
        --with-cli=readline
build       : |
    %make

    pushd py
    %pyproject_build
install     : |
    %make_install

    pushd py
    %pyproject_install
tune        :
    - lto: full
    - optimize: speed
packages    :
    - "%(name)-docs":
        paths:
            - /usr/share/doc/*

    - "python-%(name)":
        summary: "Netfilter nf_tables user library - Python library"
        description: |
            Netfilter nf_tables user library - Python Library
        rundeps:
            - "%(name)"
            - python-libs
        paths:
            - /usr/lib/python*
