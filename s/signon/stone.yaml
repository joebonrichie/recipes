#
# SPDX-FileCopyrightText: Â© 2020-2025 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : signon
version     : "8.61+git.c8ad9824"
release     : 2
upstreams   :
    # Temporary source for Qt6 support
    - git|https://gitlab.com/nicolasfella/signond.git : c8ad98249af541514ff7a81634d3295e712f1a39
homepage    : https://gitlab.com/accounts-sso/signond
license     : LGPL-2.1-only
summary     : Qt SignOn Daemon
description : |
    Qt SignOn Daemon
builddeps   :
    - binary(ar)
    - binary(doxygen)
    - binary(qmake6)
tuning      :
    - lto: full
    - optimize: speed
setup       : |
    qmake6 \
        CONFIG+=release \
        QMAKE_CFLAGS_RELEASE="${CFLAGS}" \
        QMAKE_CXXFLAGS_RELEASE="${CXXFLAGS}" \
        QMAKE_LFLAGS="${LDFLAGS}"
build       : |
    %make
install     : |
    %make_install INSTALL_ROOT="%(installroot)"

    # No static
    rm -rfv %(installroot)%(libdir)/*.a
packages    :
    - "%(name)-devel":
        paths:
            - /usr/share/dbus-1/interfaces/

    - "%(name)-qt6":
        summary: Qt SignOn Daemon - Qt6 bindings
        description: |
            Qt SignOn Daemon - Qt6 bindings
        paths:
            - /usr/lib/libsignon-qt6.so.*

    - "%(name)-qt6-devel":
        summary: Qt SignOn Daemon - Qt6 bindings - devel package
        description: |
            Qt SignOn Daemon - Qt6 bindings - devel package
        rundeps:
            - "%(name)-qt6"
        paths:
            - /usr/include/signon-qt6/
            - /usr/lib/cmake/SignOnQt6/
            - /usr/lib/pkgconfig/libsignon-qt6.pc
            - /usr/lib/libsignon-qt6.so

    - "%(name)-docs":
        paths:
            - /usr/share/doc

