#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : virtiofsd
version     : 1.13.3
release     : 3
homepage    : https://gitlab.com/virtio-fs/virtiofsd
upstreams   :
    - https://gitlab.com/virtio-fs/virtiofsd/-/archive/v1.13.3/virtiofsd-v1.13.3.tar.gz : 9d5e67e7b19f52a8d3c411acf9beed6206e9352226cbf1e2bdaa4ed609a927ce
summary     : Vhost-user virtio-fs device backend
description : |
    Vhost-user virtio-fs device backend written in Rust
license     :
    - Apache-2.0
    - BSD-3-Clause
networking  : yes
builddeps   :
    - pkgconfig(libcap-ng)
    - pkgconfig(libseccomp)
setup       : |
    %patch %(pkgdir)/0001-downstream-Use-correct-libexec.patch

    %cargo_fetch
build       : |
    %cargo_build
install     : |
    %install_exe %(cargo_target_dir)/virtiofsd -t %(installroot)%(libdir)/qemu/
    %install_file 50-virtiofsd.json %(installroot)/usr/share/qemu/vhost-user/50-virtiofsd.json
check       : |
    %cargo_test
