#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : curl
version     : 8.18.0
release     : 29
summary     : A utility for fetching files from remote servers
license     : MIT
homepage    : https://curl.se/
description : |
    A utility for fetching files from remote servers.
upstreams   :
    - https://curl.se/download/curl-8.18.0.tar.gz: e9274a5f8ab5271c0e0e6762d2fce194d5f98acc568e4ce816845b2dcc0cf88f
builddeps:
    - pkgconfig32(jansson)
    - pkgconfig32(libbrotlidec)
    - pkgconfig32(libcrypto)
    - pkgconfig32(libnghttp2)
    - pkgconfig32(libpsl)
    - pkgconfig32(libzstd)
    - pkgconfig32(zlib)
    - pkgconfig(krb5-gssapi)
    - pkgconfig(ldap)
    - pkgconfig(libnghttp3)
    - pkgconfig(libssh2)
emul32      : true
profiles    :
    - emul32:
        environment: |
            _extra_args="--disable-libssh2 --disable-ldap"
    - x86_64:
        environment: |
            _extra_args="--with-ldap --with-libssh2 --with-gssapi"
setup       : |
    %configure \
        --disable-static \
        --enable-versioned-symbols \
        --with-ca-bundle="/etc/ssl/certs/ca-certificates.crt" \
        --with-fish-functions-dir=/usr/share/fish/vendor_completions.d/ \
        --with-openssl \
        --with-openssl-quic \
        --with-zsh-functions-dir=/usr/share/zsh/site-functions/ \
        $_extra_args
build       : |
    %make
install     : |
    %make_install
# TODO enable checks
tune        :
    - nosemantic
    - optimize: size
packages    :
    - "%(name)-libs":
        rundeps:
            - ca-certificates
        paths:
            - /usr/lib/libcurl.so.*

    - "%(name)-devel":
        paths:
            - /usr/bin/curl-config
            - /usr/share/man/man1/curl-config*
